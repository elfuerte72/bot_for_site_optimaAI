# üìä –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ RAG —Å–∏—Å—Ç–µ–º—ã OptimaAI Bot

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 01.06.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### ‚úÖ 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ RAG —Å–∏—Å—Ç–µ–º—ã
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:** –°–æ–∑–¥–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–î–æ–∫—É–º–µ–Ω—Ç—ã:** –ó–∞–≥—Ä—É–∂–µ–Ω—ã 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Å–æ–∑–¥–∞–Ω–æ 12 —á–∞–Ω–∫–æ–≤
- **Embedding model:** `text-embedding-3-small` –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **Search quality:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- **Index backup:** –ò–Ω–¥–µ–∫—Å—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `/rag_index`

### ‚úÖ 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–µ–∫—Å—Ç–∞
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–ª –æ—Ç–≤–µ—Ç—ã —Å markdown —Å–∏–º–≤–æ–ª–∞–º–∏
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_clean_markdown()` –≤ `bot_interface.py`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ markdown —Å–∏–º–≤–æ–ª—ã (`**`, `*`, `#`, `` ` ``, `[]`, `()`, `>`, `|`, `~~`) —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è
- **–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç:** –û–±–Ω–æ–≤–ª–µ–Ω —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –æ—Ç–≤–µ—á–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º

### ‚úÖ 3. –ó–∞–ø—É—Å–∫ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞
- **–°–µ—Ä–≤–µ—Ä:** –ó–∞–ø—É—â–µ–Ω –Ω–∞ `http://localhost:8000`
- **API –∫–ª—é—á OpenAI:** –û–±–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–ú–æ–¥–µ–ª—å:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å `gpt-4o-nano` –Ω–∞ `gpt-4o-mini`
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—Å–µ 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –¢–µ—Å—Ç | –ó–∞–ø—Ä–æ—Å | –°—Ç–∞—Ç—É—Å | –í—Ä–µ–º—è | Markdown |
|------|--------|--------|-------|----------|
| 1 | "–†–∞—Å—Å–∫–∞–∂–∏ –æ –∫–æ–º–ø–∞–Ω–∏–∏ Optima AI" | ‚úÖ 200 | 5.60—Å | ‚úÖ –£–¥–∞–ª–µ–Ω |
| 2 | "–ö–∞–∫–∏–µ —É—Å–ª—É–≥–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ê–∫–∞–¥–µ–º–∏—è?" | ‚úÖ 200 | 4.90—Å | ‚úÖ –£–¥–∞–ª–µ–Ω |
| 3 | "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –æ–±—É—á–µ–Ω–∏–µ AI-Full Stack?" | ‚úÖ 200 | 3.02—Å | ‚úÖ –£–¥–∞–ª–µ–Ω |
| 4 | "–ö—Ç–æ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏?" | ‚úÖ 200 | 2.48—Å | ‚úÖ –£–¥–∞–ª–µ–Ω |
| 5 | "–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–æ–∫–∞—á–∫–∞ –Ω–∞–≤—ã–∫–∞ –ø—Ä–æ–º–ø—Ç–∏–Ω–≥–∞?" | ‚úÖ 200 | 4.70—Å | ‚úÖ –£–¥–∞–ª–µ–Ω |

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```env
OPENAI_API_KEY=sk-proj-*** (–æ–±–Ω–æ–≤–ª–µ–Ω)
GPT_MODEL=gpt-4o-mini (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
TEMPERATURE=0.3
MAX_TOKENS=1024
API_KEY=your_optional_api_key_for_authentication
```

### RAG —Å–∏—Å—Ç–µ–º–∞
- **–î–æ–∫—É–º–µ–Ω—Ç—ã:** 5 —Ñ–∞–π–ª–æ–≤ –≤ `/rag`
- **–ß–∞–Ω–∫–∏:** 12 —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —Ç–µ–∫—Å—Ç–∞
- **–í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:** FAISS
- **Embedding –º–æ–¥–µ–ª—å:** text-embedding-3-small
- **–ü–æ–∏—Å–∫:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–∞—Ä–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å (MMR)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ API –∫–ª—é—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Rate limiting (100 req/min)
- ‚úÖ Input sanitization
- ‚úÖ Security headers

## üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∞–π—Ç–æ–º

### –ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
1. **`INTEGRATION_GUIDE.md`** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
2. **`test_frontend.html`** - –ì–æ—Ç–æ–≤—ã–π HTML –ø—Ä–∏–º–µ—Ä —á–∞—Ç–∞
3. **`test_chat_api.py`** - –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API

### –û—Å–Ω–æ–≤–Ω—ã–µ endpoints:
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- `POST /chat` - –û—Å–Ω–æ–≤–Ω–æ–π API –¥–ª—è —á–∞—Ç–∞
- `GET /metrics` - –ú–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- `POST /cache/clear` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º

### –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
```javascript
const response = await fetch('http://localhost:8000/chat', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': 'your_optional_api_key_for_authentication'
  },
  body: JSON.stringify({
    messages: [
      { role: 'user', content: '–†–∞—Å—Å–∫–∞–∂–∏ –æ –∫–æ–º–ø–∞–Ω–∏–∏' }
    ]
  })
});
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### RAG –°–∏—Å—Ç–µ–º–∞ ‚úÖ
- [x] **–í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** —Å–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [x] **–î–æ–∫—É–º–µ–Ω—Ç—ã** –∞–∫—Ç—É–∞–ª—å–Ω—ã –∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- [x] **Embedding model** –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [x] **Search quality** –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
- [x] **Index backup** –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### API ‚úÖ
- [x] **–°–µ—Ä–≤–µ—Ä** –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- [x] **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [x] **CORS** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- [x] **Rate limiting** –∞–∫—Ç–∏–≤–µ–Ω
- [x] **Error handling** —Ä–∞–±–æ—Ç–∞–µ—Ç

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
- [x] **Markdown —Å–∏–º–≤–æ–ª—ã** —É–¥–∞–ª—è—é—Ç—Å—è
- [x] **–¢–µ–∫—Å—Ç** —á–∏—Å—Ç—ã–π –∏ —á–∏—Ç–∞–µ–º—ã–π
- [x] **–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç** –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] **–û—Ç–≤–µ—Ç—ã** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚úÖ
- [x] **–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** —Å–æ–∑–¥–∞–Ω–æ
- [x] **–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞** –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã
- [x] **HTML —Ç–µ—Å—Ç** –≥–æ—Ç–æ–≤
- [x] **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –∞–∫—Ç—É–∞–ª—å–Ω–∞

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–∞–π—Ç—É

### 1. –û–±–Ω–æ–≤–∏—Ç–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
–î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞ –≤ `.env`:
```env
ALLOWED_ORIGINS=["http://localhost:3000", "https://yourdomain.com"]
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π JavaScript –∫–æ–¥
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª–∞—Å—Å `OptimaAIBot` –∏–∑ `INTEGRATION_GUIDE.md` –≤ –≤–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥.

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —á–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `test_frontend.html` –∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è –≤–∞—à–µ–≥–æ —á–∞—Ç-–≤–∏–¥–∂–µ—Ç–∞.

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ:
- `/health` - —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- `/metrics` - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- `app.log` - –ª–æ–≥–∏ –æ—à–∏–±–æ–∫

### 5. –ü—Ä–æ–¥–∞–∫—à–µ–Ω
–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- –°–º–µ–Ω–∏—Ç–µ `DEBUG=false`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã RAG

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `app.log`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python test_chat_api.py`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/health`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS

---

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** RAG —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–∞—à–∏–º —Å–∞–π—Ç–æ–º. –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ, markdown —Å–∏–º–≤–æ–ª—ã —É–¥–∞–ª—è—é—Ç—Å—è, API —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ.