# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ Heroku

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- [ ] Docker Desktop –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Heroku CLI —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`brew tap heroku/brew && brew install heroku`)
- [ ] –í—ã –∑–∞–ª–æ–≥–∏–Ω–µ–Ω—ã –≤ Heroku (`heroku login`)
- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ git
- [ ] .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω (–Ω–æ –ù–ï –∑–∞–∫–æ–º–º–∏—á–µ–Ω!)

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- [ ] `Procfile` —Å–æ–∑–¥–∞–Ω —Å –∫–æ–º–∞–Ω–¥–æ–π –∑–∞–ø—É—Å–∫–∞
- [ ] `runtime.txt` —É–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é Python 3.11.10
- [ ] `Dockerfile.heroku` –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è Heroku
- [ ] `heroku.yml` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è
- [ ] `requirements-prod.txt` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–¥–∞–∫—à–Ω –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## üß™ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç Docker –æ–±—Ä–∞–∑–∞:
   ```bash
   ./scripts/test-docker-locally.sh
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç:
   ```bash
   curl http://localhost:8000/health
   ```

3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
   ```bash
   curl -X POST "http://localhost:8000/chat" \
     -H "Content-Type: application/json" \
     -H "X-API-Key: your-api-key" \
     -d '{"messages": [{"role": "user", "content": "–ü—Ä–∏–≤–µ—Ç!"}]}'
   ```

4. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
   ```bash
   docker-compose -f docker-compose.test.yml down
   ```

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Heroku

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
./scripts/deploy-heroku.sh your-app-name
```

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω–æ):
   ```bash
   heroku create your-app-name
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ container stack:
   ```bash
   heroku stack:set container -a your-app-name
   ```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
   heroku config:set OPENAI_API_KEY="sk-..." -a your-app-name
   heroku config:set API_KEY="your-secure-api-key" -a your-app-name
   heroku config:set ALLOWED_ORIGINS="https://your-frontend.com" -a your-app-name
   
   # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
   heroku config:set GPT_MODEL="gpt-4o-mini" -a your-app-name
   heroku config:set RATE_LIMIT_PER_MINUTE="30" -a your-app-name
   heroku config:set ENABLE_CACHE="true" -a your-app-name
   ```

4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–ø–ª–æ–π:
   ```bash
   git push heroku main
   ```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   heroku logs --tail -a your-app-name
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:
   ```bash
   heroku ps -a your-app-name
   ```

3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API:
   ```bash
   curl https://your-app-name.herokuapp.com/health
   ```

4. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
   ```bash
   heroku open /docs -a your-app-name
   ```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–ü–æ—Ä—Ç**: Heroku –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –ø–æ—Ä—Ç —á–µ—Ä–µ–∑ `$PORT`
2. **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞**: Ephemeral - —Ñ–∞–π–ª—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Ä–µ—Å—Ç–∞—Ä—Ç–∞–º–∏
3. **–¢–∞–π–º–∞—É—Ç**: 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
4. **–ü–∞–º—è—Ç—å**: Free tier = 512MB RAM
5. **–°–æ–Ω**: Free apps –∑–∞—Å—ã–ø–∞—é—Ç –ø–æ—Å–ª–µ 30 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
heroku logs --tail -a your-app-name
heroku restart -a your-app-name
```

### –û—à–∏–±–∫–∏ —Å –ø–∞–º—è—Ç—å—é
- –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤
- –û–±–Ω–æ–≤–∏—Ç–µ—Å—å –¥–æ –ø–ª–∞—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∞

### –ü—Ä–æ–±–ª–µ–º—ã —Å RAG
- RAG –∏–Ω–¥–µ–∫—Å –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ
- –î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ S3 –∏–ª–∏ –¥—Ä—É–≥–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –ú–µ—Ç—Ä–∏–∫–∏: `https://your-app-name.herokuapp.com/metrics`
- –°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: `https://your-app-name.herokuapp.com/security/status`
- Heroku Dashboard: `https://dashboard.heroku.com/apps/your-app-name`

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
git add .
git commit -m "Update: –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
git push heroku main
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å RAG —Å–∏—Å—Ç–µ–º–æ–π —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:
`https://your-app-name.herokuapp.com`

–ù–µ –∑–∞–±—É–¥—å—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å ALLOWED_ORIGINS –¥–ª—è –≤–∞—à–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞!